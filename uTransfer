<!DOCTYPE html>
<html>
	<head>
		<meta
			charset="utf-8"
		>
		<title>
			Delta-v calculator
		</title>
		<link
			rel="icon"
			href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABI1BMVEX///90dHRAQEB1dXWAgIBOTk5DQ0NtbW11dXVRUVFqampaWlp1dXVKSkpMTExgYGBlZWVeXl5ycnJQUFBOTk5kZGRhYWFeXl5vb29RUVFQUFBhYWFjY2NtbW1OTk5PT09eXl5lZWVqampYWFhNTU1OTk5QUFBSUlJTU1NUVFRVVVVWVlZXV1dZWVlbW1tcXFxdXV1eXl5gYGBhX1dhYWFiYmJkV1llYlxmXl9mYGFnYWJoYWJtYGJ+U1h/VFqAVVqBVlyQXWSRXmWbXmadWGGeYWmgXGWoW2WpXGarX2asYGqtYmmuYmyvmV6wm2C/omDAo2HFXWvFX23GX2zGYG3Mr2LOsWLTX2/UYG/cYXHeZHTqZHXqZHbsY3XwZHbxZXf/ZnrBGVS7AAAAJHRSTlMACwwjJCcqjI6RkZOWl560tLW4vb7S09TV2Nnw8PHz8/f39/ijTRVpAAAAyUlEQVQYGQXB0U6DMBSA4f+c2pbJMEzZjCTGN/D9n8N7nXoxIotm6tygLdTvE+CicM4SQxgSCOLbGwDgczdmwT8C9l7eEvA0qmkBlouinIDWqG8AKqiOEzReHQCXsMynDE4tAOb5xUg+Z6x6AOg6RBmzN1UFvvXTVb0akuSTWdRUDwWrGteks/7oCLcKAHKnEjRBT/cR075nLxIMpszxdR2jvNvD/HUw87iZjvOw1t38O5vtKGi5uZ4ioiLf/d8sgCussxJDGAL8A9NKUSlFuG+BAAAAAElFTkSuQmCC"
		>
		<style>
			body{
				color:
					#FFC800;
				background-color:
					#000000;
			}
			th{
				text-align:
					left;
			}
			.distance{
				width:
					50%;
			}
			#result{
				color:
					#00C800;
				font-size:
					150%;
			}
		</style>
		<script>
	var space
	= {
		earth:{
			mu:
				3.986004418e14,
			radius:
				6.371e6,
			parent:
				"sun",
			satellites:
				true,
			atmosphere:
				true,
			deltaToOrbit:
				9500,
			thickness:
				100000
		},
		jupiter:{
			/*mu:
				3.986004418e14,
			radius:
				6.371e6,*/
			parent:
				"sun",
			satellites:
				true,
			atmosphere:
				true,
			/*deltaToOrbit:
				9500,
			thickness:
				100000*/
		},
		mars:{
			mu:
				4.282837e13,
			radius:
				3.3895e6,
			parent:
				"sun",
			satellites:
				true,
			atmosphere:
				true,
			deltaToOrbit:
				3600,
			thickness:
				80000
		},
		mercury:{
			mu:
				2.2032E13,
			//radius:
			parent:
				"sun",
			satellites:
				false
		},
		moon:{
			mu:
				4.9048695e12,
			radius:
				1.7371e6,
			parent:
				"earth",
			satellites:
				false
		},
		sun:{
			mu:
				1.32712440018e20,
			//radius:
			parent:
				"milkyway",
			satellites:
				true
		},
		venus:{
			mu:
				3.24859e14,
			radius:
				6.0518e6,
			parent:
				"sun",
			satellites:
				false,
			atmosphere:
				true,
			deltaToOrbit:
				27000,
			thickness:
				250000
		}
	}
		</script>
	</head>
	<body>
		<center>
			<h1>
				Delta-v calculator
			</h1>
			<div>
				<table>
					<tr>
						<th>
							From:
						</th>
						<th>
							To:
						</th>
					</tr>
					<tr>
						<td>
							<form
								id="form0"
								onclick="formUpdate(0)"
							>
								<select
									name="object"
								>
									<option
										value="earth"
										selected
									>
										Earth
									</option>
									<option
										value="moon"
									>
										Moon
									</option>
									<option
										value="mars"
									>
										Mars
									</option>
								</select>
								<br>
								<input
									type="radio"
									name="location"
									value="surface"
								>
								Surface
								<br>
								<span
									id="atmosphere"
									style="display:none"
								>
									&nbsp;&nbsp;
									<input
										type="checkbox"
										name="drag"
										checked
									>
									Include drag?
									<br>
								</span>
								<input
									type="radio"
									name="location"
									value="orbit"
									checked
								>Orbit<br>
								<input
									type="radio"
									name="location"
									value="escape"
								>
								Escape velocity
								<br>
								<span
									id="alt0"
								>
									<p>
										Height of orbit:
									</p>
									<input
										type="text"
										class="distance"
										name="distance"
										value="220"
									>
									m
									<br>
									<input
										type="radio"
										name="alt"
										checked
									>
									Altitude
									<input
										type="radio"
										name="alt"
									>
									Radius
									<br>
								</span>
							</form>
						</td>
						<td>
							<form
								id="form1"
								onclick="formUpdate(1)"
							>
								<select
									name="object"
								>
									<option
										value="earth"
									>
										Earth
									</option>
									<option
										value="moon"
										selected
									>
										Moon
									</option>
									<option
										value="mars"
									>
										Mars
									</option>
								</select>
								<br>
								<input
									type="radio"
									name="location"
									value="surface" 
									checked
								>
								Surface
								<br>
								<span
									id="aero"
									style="display:none"
								>
									&nbsp;&nbsp;
									<input
										type="checkbox"
										name="brake"
										checked
									>
									Allow aerobraking?
									<br>
								</span>
								<input
									type="radio"
									name="location"
									value="prbit"
								>
								Orbit
								<br>
								<input
									type="radio"
									name="location"
									value="escape"
								>
								Escape velocity
								<br>
								<span
									id="alt1"
									style="visibility:hidden"
								>
									<p>
										Height of orbit:
									</p>
									<input
										type="text"
										class="distance"
										name="distance"
									>
									m
									<br>
									<input
										type="radio"
										name="alt"
										checked
									>
									Altitude
									<input
										type="radio"
										name="alt"
									>
									Radius
									<br>
								</span>
							</form>
						</td>
					</tr>
				</table>
				<p
					id="result"
				>m/s</p>
				<p
					id="guide"
				></p>
			</div>
			<a
				href="http://moonwards.com/index.html"
			>
				Back to Moonwards
			</a>
		</center>
		<script>
			var locationLogic
			= function(
				trg
			){
				var delta
					= 0;
				var radius
				= [
					trg[
						0
					]
						.radius,
					trg[
						1
					]
						.radius,
					space [
						trg[
							0
						]
							.parent
					]
						.radius
				]
				if(
					trg[
						0
					]
						.parent
					=== trg[
						1
					]
						.parent
				){
					if(
						trg[
							0
						]
							.location
						=== trg[
							1
						]
							.location
					){
						return 0
					}
					else if(
						trg[
							0
						]
							.location
						=== "surface"
					||
						trg[
							1
						]
							.location
						=== "surface"
					){
						var esci
						= Math
							.sqrt(
								space[
									trg[
										0
									]
										.parent
								]
									.mu
								* 2 / radius [
									2
								]
							);
						if(
							trg[
								0
							]
								.location
							=== "surface"
						){
							if(
								atmosphere
							){
								delta
								+= space[
									trg[
										0
									]
										.parent
								]
									.deltaToOrbit;
							}
							else if(
								trg[
									1
								]
									.location
								=== "escape"
							){
								return esci
							}
							else{
								return Math
									.sqrt(
										space[
											trg[
												0
											]
												.parent
										]
											.mu
										* (
											2 / radius[
												2
											]
											- 2 / (
												radius[
													2
												]
												+ radius[
													1
												]
											)
										)
									)
								+ Math
									.sqrt(
										space[
											trg[
												0
											]
												.parent
										]
											.mu
										/ radius[
											1
										]
									)
								- Math
									.sqrt(
										space[
											trg[
												0
											]
												.parent
										]
											.mu
										* (
											2 / radius[
												1
											]
											- 2 / (
												radius[
													2
												]
												+ radius[
													1
												]
											)
										)
									)
							}
						}
						else{
							if(
								aero
							){
								if(
									trg[
										0
									]
										.location
									=== "escape"
								){
									return 0
								}
								else{
									return Math
										.sqrt(
											space[
												trg[
													0
												]
													.parent
											]
												.mu
											/ radius[
												0
											]
										)
									- Math
										.sqrt(
											space[
												trg[
													0
												]
													.parent
											]
												.mu
											* (
												2 / trg[
													0
												]
													.radius
												- 2 / (
													space[
														trg[
															0
														]
															.parent
													]
														.radius
													+ space[
														trg[
															0
														]
															.parent
													]
														.thickness
													+ trg[
														0
													]
														.radius
												)
											)
										)
								}
							}
							else{
								if(
									trg[
										0
									]
										.location
									=== "escape"
								){
									return esci
								}
								else{
									delta
									= Math
										.sqrt(
											space[
												trg[
													0
												]
													.parent
											]
												.mu
											/ trg[
												0
											]
												.radius
										)
									- Math
										.sqrt(
											space[
												trg[
													0
												]
													.parent
											]
												.mu
											* (
												2 / trg[
													0
												]
													.radius
												- 2 / (
													space[
														trg[
															0
														]
															.parent
													]
														.radius
													+ trg[
														0
													]
														.radius
												)
											)
										)
									+ Math
										.sqrt(
											space[
												trg[
													0
												]
													.parent
											]
												.mu
											* (
												2 / space[
														trg[
															0
														]
															.parent
													]
														.radius
												- 2 / (
													space[
														trg[
															0
														]
															.parent
													]
														.radius
													+ trg[
														0
													]
														.radius
												)
											)
										);
									return Math
										.min(
											delta,
											esci
										)
								}
							}
						}
					}
					else if(
						trg[
							0
						]
							.location
						=== "escape"
					&&
						trg[
							1
						]
							.location
						=== "escape"
					){
						return 0
					}
					else if(
						trg[
							0
						]
							.location
						=== "orbit"
					&&
						trg[
							1
						]
							.location
						=== "orbit"
					){
						var radiRatio
							= radius[
								0
							] / radius[
								1
							];
						if(//needs better accuracy than 11.94
							radiRatio > 11.94
						||
							1 / radiRatio > 11.94
						){
							return (
								Math
									.sqrt(
										2
									)
								- 1
							) * (
								Math
									.sqrt(
										space[
											trg[
												0
											]
												.parent
										]
											.mu
										/ radius[
											0
										]
									)
								+ Math
									.sqrt(
										space[
											trg[
												0
											]
												.parent
										]
											.mu
										/ radius[
											1
										]
									)
							)
						}
						else{
							return /**/
						}
					}
					else if(
						trg[
							0
						]
							.location
						=== "orbit"
					){
						return (
							Math
								.sqrt(
									2
								)
							- 1
						) * Math
							.sqrt(
								space[
									trg[
										0
									]
										.parent
								]
									.mu
								/ trg[
									0
								]
									.radius
							)
					}
					else{
						return (
							Math
								.sqrt(
									2
								)
							- 1
						) * Math
							.sqrt(
								space[
									trg[
										0
									]
										.parent
								]
									.mu
								/ trg[
									1
								]
									.radius
							)
					}
				/*}
				else if(){*/
				}
			};
			var target
			= [
				{
					parent:
						"earth",
					location:
						"orbit",
					radius:
						6591000
				},
				{
					parent:
						"moon",
					location:
						"surface",
					radius:
						1736000
				}
			];
			var forms
			= [
				document
					.getElementById(
						"form0"
					),
				document
					.getElementById(
						"form1"
					)
			];
			var formUpdate
			= function(
				form
			){
				var aero
					= false;
				var atmosphere
					= false;
				document
					.getElementById(
						"aero"
					)
					.style
					.display
				= "none";
				document
					.getElementById(
						"atmosphere"
					)
					.style
					.display
				= "none";
				document
					.getElementById(
						"alt" + form
					)
					.style
					.visibility
				= "hidden";
				target[
					form
				]
					.parent
				= forms[
					form
				]
					.elements
					.object
					.selectedOptions[
						0
					]
					.value;
				if(
					forms[
						form
					]
						.elements
						.location
						.value
					=== "surface"
				){
					target[
						form
					]
						.location
					= "surface";
					if(
						space[
							forms[
								form
							]
								.elements
								.object
								.selectedOptions[
									0
								]
								.value
						]
							.atmosphere
					){
						if(
							form
						){
							document
								.getElementById(
									"aero"
								)
								.style
								.display
							= "inline";
							if(
								forms[
									0
								]
									.elements
									.drag
									.checked
							){
								atmosphere
									= true
							}
						}
						else{
							document
								.getElementById(
									"atmosphere"
								)
								.style
								.display
							= "inline";
							if(
								forms[
									1
								]
									.elements
									.brake
									.checked
							){
								aero
									= true
							}
						}
					}
				}
				else{
					document
						.getElementById(
							"alt" + form
						)
						.style
						.visibility
					= "visible";
					if(
						forms[
							form
						]
							.elements
							.alt[
								0
							]
							.checked
					){
						target[
							form
						]
							.radius
						= space[
							target[
								form
							]
								.parent
						]
							.radius
						+ Number(
							forms[
								form
							]
								.elements
								.distance
								.value
						)
					}
					else{
						target[
							form
						]
							.radius
						= Number(
							forms[
								form
							]
								.elements
								.distance
								.value
						)
					}
				};
				var deltaV
				= locationLogic(
					target
				);
			}
		</script>
	</body>
</html>
