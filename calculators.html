<!DOCTYPE html>
<html>
	<head>
		<title>Calculators</title>
		<meta charset="UTF-8">
		<meta name="author" content="Sigvart Brendberg">
		<style>
			.icons{
				position: absolute;
				margin-top: 60px;
				margin-left: -132px;
			}
		</style>
		<script src="js/space.js"></script>
	</head>
<body>
	<h1>Calculator Page</h1>
	<p>Simple HTML version</p>
	<div>
		<h3>The Rocket Equation</h3>
		<p>Mass ratio:</p>
		<input type="text" placeholder="Start mass divided by end mass" value="" id="massratioRE">
		<p>Exhaust velocity: (m/s)</p>
		<input type="text" placeholder="Velocity of the rocket exhaust" value="" id="exhaustvelocityRE">
		<input type="checkbox" id="ispcheckboxRE">use Isp instead
		<br><br>
		<button onclick="rocket()">Calculate!</button>
		<p id="resultRE">&nbsp;</p>
	</div>
	<div>
		<h3>Suborbital Hop</h3>
		<p>Initial location:</p>
		Latitude <input type="text" placeholder="(degrees)" value="" id="latitudeSH">
		Longitude <input type="text" placeholder="(degrees)" value="" id="longitudeSH">
		<p>Destination location:</p>
		Latitude <input type="text" placeholder="(degrees)" value="" id="destinationlatitudeSH">
		Longitude <input type="text" placeholder="(degrees)" value="" id="destinationlongitudeSH"><br>
		<div>
			<img src="img/mapmini.gif" width="256" height="128">
			<img src="img/icon.png" class="icons" id="initialicon" width="9" height="9">
			<img src="img/icon.png" class="icons" id="destinationicon" width="9" height="9">
		</div>
		<br><br>
		<button onclick="subhop()">Calculate!</button>
		<p id="resultSH">&nbsp;</p>
		<p>More about suborbital hops <a href="http://hopsblog-hop.blogspot.com/2015/08/lunar-pogo-hopper.html">here</a>, by Hop David.</p>
	</div>
	<br>
	<a href="http://www.gnu.org/licenses/">
		All calculator scripts are released under GPL 3
	</a>
<script>
//now depends on space.js
var idIcon = 0;
//Common opperations:
rad = function(degrees){ //for converting to radians
	return degrees/180 * Math.PI;
};
//main functions:
rocket = function(){
	var ispcheck = document.getElementById("ispcheckboxRE").checked;
	var just = 1;
	if(ispcheck){
		just = space.earth.gravity
	};
	var exhaust = Number(document.getElementById("exhaustvelocityRE").value);
	var massratio = Number(document.getElementById("massratioRE").value);
	var result = Math.log(massratio) * exhaust * just;
	result = Math.round(result*100)/100;
	document.getElementById("resultRE").innerHTML = "Delta-v: <b>" + result + " m/s</b>";
};
subhop = function(){
//inputs
	var longitude1 = (Number(document.getElementById("longitudeSH").value))%360;
    if(longitude1 < -180){
		longitude1 += 360
	}
	else if(longitude1 > 180){
		longitude1 -= 360
	};
	var latitude1 = (Number(document.getElementById("latitudeSH").value))%360;
	var longitude2 = (Number(document.getElementById("destinationlongitudeSH").value))%360;
	if(longitude2 < -180){
		longitude2 += 360
	}
	else if(longitude2 > 180){
		longitude2 -= 360
	};
	var latitude2 = (Number(document.getElementById("destinationlatitudeSH").value))%360;
//main
	var cords1 = space.math.toXYZ(longitude1,latitude1);
	var cords2 = space.math.toXYZ(longitude2,latitude2);
	var distance = Math.sqrt(
		  Math.pow(space.moon.radius*(cords1.x - cords2.x),2)
		+ Math.pow(space.moon.radius*(ords1.y - cords2.y),2)
		+ Math.pow(space.moon.radius*(cords1.z - cords2.z),2)
	);
//output
	var totalDeltav = 2 * Math.sqrt(
		space.moon.gm * (2/space.moon.radius - 1/(space.moon.radius/2 + distance/4))
	);
	totalDeltav = Math.round(totalDeltav*100)/100;
	document.getElementById("resultSH").innerHTML = "Delta-v: <b>" + totalDeltav + " m/s</b> ("+Math.round((totalDeltav/3359.84)*100)+"% of an orbital mission)";
//graphics:
	var xcoord1 = (longitude1 - 180)*256/360 - 4;
	var ycoord1 = (90 - latitude1)*128/180 - 4;
	var xcoord2 = (longitude2 - 180)*256/360 - 4;
	var ycoord2 = (90 - latitude2)*128/180 - 4;
	document.getElementById("initialicon").style.marginLeft = xcoord1+"px";
	document.getElementById("initialicon").style.marginTop = ycoord1+"px";
	document.getElementById("destinationicon").style.marginLeft = xcoord2+"px";
	document.getElementById("destinationicon").style.marginTop = ycoord2+"px";
};
</script>
</body>
</html>
